{"ast":null,"code":"import { createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { createAppThunk } from \"./store\";\nimport * as modal from \"./modal/modal.slice\";\nconst initialState = {\n  imageID: 0,\n  screen: \"pick\",\n  marked: [],\n  reasons: [{\n    id: \"bg\",\n    label: \"Background\"\n  }, {\n    id: \"eyes\",\n    label: \"Eyes\"\n  }]\n};\nconst appSlice = createSlice({\n  name: \"trainer\",\n  initialState,\n  reducers: {\n    real: state => {\n      state.imageID = (state.imageID + 1) % 16;\n    },\n    unreal: state => {\n      state.screen = \"modal\";\n    },\n    confirm: (state, action) => {\n      const {\n        other\n      } = action.payload;\n\n      if (other) {\n        state.reasons[other.id] = other;\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(modal.cancel, state => {\n      state.screen = \"pick\";\n    });\n  }\n});\nexport const initialise = createAppThunk(\"trainer/init\", async () => {\n  const response = await axios.get(\"http://localhost:3000/api/v1/image?id=1\", {\n    responseType: \"stream\"\n  });\n  console.log(response);\n});\nexport const {\n  real,\n  unreal\n} = appSlice.actions;\nexport default appSlice.reducer;","map":{"version":3,"sources":["/home/tomw/ai-trainer/client/src/app.slice.ts"],"names":["createSlice","axios","createAppThunk","modal","initialState","imageID","screen","marked","reasons","id","label","appSlice","name","reducers","real","state","unreal","confirm","action","other","payload","extraReducers","builder","addCase","cancel","initialise","response","get","responseType","console","log","actions","reducer"],"mappings":"AAAA,SACEA,WADF,QAKO,kBALP;AAMA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAAmBC,cAAnB,QAAyC,SAAzC;AACA,OAAO,KAAKC,KAAZ,MAAuB,qBAAvB;AAaA,MAAMC,YAA0B,GAAG;AACjCC,EAAAA,OAAO,EAAE,CADwB;AAEjCC,EAAAA,MAAM,EAAE,MAFyB;AAGjCC,EAAAA,MAAM,EAAE,EAHyB;AAIjCC,EAAAA,OAAO,EAAE,CACP;AAAEC,IAAAA,EAAE,EAAE,IAAN;AAAYC,IAAAA,KAAK,EAAE;AAAnB,GADO,EAEP;AAAED,IAAAA,EAAE,EAAE,MAAN;AAAcC,IAAAA,KAAK,EAAE;AAArB,GAFO;AAJwB,CAAnC;AAUA,MAAMC,QAAQ,GAAGX,WAAW,CAAC;AAC3BY,EAAAA,IAAI,EAAE,SADqB;AAE3BR,EAAAA,YAF2B;AAG3BS,EAAAA,QAAQ,EAAE;AACRC,IAAAA,IAAI,EAAGC,KAAD,IAAW;AACfA,MAAAA,KAAK,CAACV,OAAN,GAAgB,CAACU,KAAK,CAACV,OAAN,GAAgB,CAAjB,IAAsB,EAAtC;AACD,KAHO;AAIRW,IAAAA,MAAM,EAAGD,KAAD,IAAW;AACjBA,MAAAA,KAAK,CAACT,MAAN,GAAe,OAAf;AACD,KANO;AAORW,IAAAA,OAAO,EAAE,CACPF,KADO,EAEPG,MAFO,KAGJ;AACH,YAAM;AAAEC,QAAAA;AAAF,UAAYD,MAAM,CAACE,OAAzB;;AACA,UAAID,KAAJ,EAAW;AACTJ,QAAAA,KAAK,CAACP,OAAN,CAAcW,KAAK,CAACV,EAApB,IAA0BU,KAA1B;AACD;AACF;AAfO,GAHiB;AAoB3BE,EAAAA,aAAa,EAAGC,OAAD,IAAa;AAC1BA,IAAAA,OAAO,CAACC,OAAR,CAAgBpB,KAAK,CAACqB,MAAtB,EAA+BT,KAAD,IAAW;AACvCA,MAAAA,KAAK,CAACT,MAAN,GAAe,MAAf;AACD,KAFD;AAGD;AAxB0B,CAAD,CAA5B;AA2BA,OAAO,MAAMmB,UAAU,GAAGvB,cAAc,CAAC,cAAD,EAAiB,YAAY;AACnE,QAAMwB,QAAQ,GAAG,MAAMzB,KAAK,CAAC0B,GAAN,CAAU,yCAAV,EAAqD;AAC1EC,IAAAA,YAAY,EAAE;AAD4D,GAArD,CAAvB;AAGAC,EAAAA,OAAO,CAACC,GAAR,CAAYJ,QAAZ;AACD,CALuC,CAAjC;AAOP,OAAO,MAAM;AAAEZ,EAAAA,IAAF;AAAQE,EAAAA;AAAR,IAAmBL,QAAQ,CAACoB,OAAlC;AAEP,eAAepB,QAAQ,CAACqB,OAAxB","sourcesContent":["import {\n  createSlice,\n  Dictionary,\n  nanoid,\n  PayloadAction,\n} from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { AppState, createAppThunk } from \"./store\";\nimport * as modal from \"./modal/modal.slice\";\n\ntype Marked = { imageID: string; reasonIDs: string[] };\n\ntype Reason = { id: string; label: string };\n\ninterface TrainerState {\n  imageID: number;\n  screen: \"pick\" | \"modal\" | \"report\";\n  marked: Marked[];\n  reasons: Reason[];\n}\n\nconst initialState: TrainerState = {\n  imageID: 0,\n  screen: \"pick\",\n  marked: [],\n  reasons: [\n    { id: \"bg\", label: \"Background\" },\n    { id: \"eyes\", label: \"Eyes\" },\n  ],\n};\n\nconst appSlice = createSlice({\n  name: \"trainer\",\n  initialState,\n  reducers: {\n    real: (state) => {\n      state.imageID = (state.imageID + 1) % 16;\n    },\n    unreal: (state) => {\n      state.screen = \"modal\";\n    },\n    confirm: (\n      state,\n      action: PayloadAction<{ reasonIDs: string[]; other?: Reason }>\n    ) => {\n      const { other } = action.payload;\n      if (other) {\n        state.reasons[other.id] = other;\n      }\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(modal.cancel, (state) => {\n      state.screen = \"pick\";\n    });\n  },\n});\n\nexport const initialise = createAppThunk(\"trainer/init\", async () => {\n  const response = await axios.get(\"http://localhost:3000/api/v1/image?id=1\", {\n    responseType: \"stream\",\n  });\n  console.log(response);\n});\n\nexport const { real, unreal } = appSlice.actions;\n\nexport default appSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}